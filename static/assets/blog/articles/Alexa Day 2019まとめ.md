神戸で開催された[Alexa Day 2019](https://alexaday2019.aajug.jp/)に参加してきた。神戸はいいサウナが多くて最高。

近くの神戸サウナで朝ウナ（あさサウナ）した。

<p class="img"><img src="/assets/blog/images/25/1.jpg" alt=""></p>

以下あとで見返せるよう内容を走り書きした。

## ASK 最新アップデート Amazonの吉田さん

### Alexa Everywhere

Alexaがいたるところにいる世界を目指している。

- [GO:PIANO with Alexa Built-in - Roland](https://www.roland.com/jp/news/0820/)
- [WH-1000XM3 - Sony](https://www.sony.jp/hea"dphone/products/WH-1000XM3/)
    - Alexa mobile accessory kit(AMA)を使用して、Bluetoothでスマホと繋がりスマホの回線を使ってAlexaとつながっている
- Echo inputであらゆるスピーカーにAlexaが搭載される
- Win10のAlexaアプリなどなど

### APL実例

マルチモーダルなスキルもどんどん増えている。Alexa Everywhereに向けて、マルチモーダルは必須だと自分も思う。

- [ジョルダン](https://norikae.jorudan.co.jp/ss/alexa/)
- [超!A&G+](https://www.agqr.jp/topics/archives/alexa181218.php)
- [防災情報](https://www.amazon.co.jp/dp/B07PRJLLT5/)
- [ひょっこりはん](https://www.amazon.co.jp/dp/B07NCRRS3P/)

### 今後増えそう

- ゲーム系
    - 画面メインではないので、想像力を掻き立てる
    - AR/VRなどコンソール系ゲームの操作支援など
- スマートホーム系
- リスト/リマインダー
    - カスタムスキルからリマインダーを追加できる
        - アパマンショップで、引越しのタスクリストを作成するスキル
    - プロアクティブイベントで通知も可能
- 移動中に使用する
    - Alexa Everywhereな世界が広がれば移動しながら使われるシーンも想定される

### BluePrintについて

8種類のテンプレートが用意されている

#### カスタムQ&A
ユーザーが発話する質問とそれに対してAlexaが答える内容を設定する。
日常的な、でも忘れがちな情報を溜め込んでおくと便利
呼び出し名が不要。

#### フラッシュカード
カスタムQ&Aとは逆で、Alexaの質問を設定して、ユーザーがそれに対して答えるテンプレ。
トピック、質問、答えを設定する。

#### メッセージテンプレ
メッセージをテキストor音声でシェアできる。

### マーケティング
Echo Showではスキルストアに表示できる。AlexaのSEO。

### Alexa Hostedスキル
AWSのアカウントを別途作らなくてすむ。
Hostedスキルの場合は、エンドポイントの設定は不要。クラウドウォッチやS3も使用可能。

### 処理プロファイル
バックエンドのコードを書かなくても、発話に紐づくインテントの確認やエンティティのチェックができるようになった。

### インテントチェーン
Launch Intentからダイレクトに他のインテントに委譲できるようになった。
これによりユーザのステップが一つ減る。

### 動的エンティティ
詳細は[Developers.IOさん](https://dev.classmethod.jp/cloud/alexa-dynamic-entities/)の記事参照。

コード側で動的にエンティティを追加できるようになった。
これまでは対話モデルを変更した後は再度審査が必要だったが、動的エンティティを使えば期間限定のテンティティを追加したりすることができるようになる。

---

## 交通情報系スキルのテクニック

[スライド](https://www.slideshare.net/MasamiYamate1/ss-139656149?ref=https://dev.classmethod.jp/voice-assistant/amazon-alexa/alexa-day-2019-session-162/)

[ジョルダンのAlexaスキル](https://norikae.jorudan.co.jp/ss/alexa/)

### Lambdaが遅い

- Lambdaのコールドスタートが影響している。

コンテナで動いているので、利用可能コンテナがないと立ち上がりが遅くなってしまう。
定期的にリクエストを行うことで解決できるが、ユーザーの利用タイミングが読めないのでけっこうむずい。

#### Lambdaのフロー（上5つはCloudwatchでは測れない）

+ ENIの作成（VPC利用時のみ）10~30秒かかる
+ コンテナ作成
+ デプロイパッケージのロード
+ パッケージの展開
+ ランタイムの起動、初期化
+ メソッドの実行

1から6まですべて行うのがコールドスタート。コンテナが生きていれば6番だけ実行される。

### 解決策
- Lambdaのメモリ割当量をふやす
- Lambdaを捨てる。

なげられたJSONを処理して、レスを返すAPIを作ればスキルとしては動く。
Node.js + Express + ASK + forever（デーモン化モジュール）

ジョルダンスキルは朝せわしなく準備している時に使うことが多いので、すぐレスを返して欲しい。
1秒稼ぐためにLambdaを捨てた。

ただしhttpsでつくるならリクエスト要件を満たすことが必須。Alexa verifierというパッケージで検証できる。
審査提出後、アメリカで自動テストを行いそれに通れば、日本の審査に回されている感じらしい（多分）

### バス案内

VUIが使われる場所が増えることが見えてきているので今からマルチモーダル対応していくべき。

ユーザー・デバイスを識別するためにはuserIdとdeviceIdが活用できる

- userId: スキル + アカウントごとにユニーク
- deviceId: スキル + アカウント + deviceごとにユニーク

音声でお気に入りのバス停を登録したかったが、全国のバス停の数が多すぎて登録可能スロットの数が足りず、アカウントリンクページ経由にした。

### トークン管理

- Login with amazonを使うと楽
- アクセストークンはアカウントIDに一つだけ紐づけられる
- アカウントリンクではuserId、deviceIdが取れない。
- 新しいデバイスを登録した時にuserIDにひもづいたお気に入りをデバイスに紐づけるかどうかを選択させるフローを追加した。
- voice Profile時にuserIdが変わるかどうか

---

## スマートスピーカーで提供する料理体験 by cookpad

[スキル](https://info.cookpad.com/pr/news/press_2018_0726)

- 材料からレシピを提供。手順も教えてくれる。
- Show上で作り方動画も見れる。スペイン、メキシコ対応している。
- Google Home, Clova Deskでも提供している

### なぜ手広くやっているか

- 料理とVUIの相性がいい。
    - 情報の入出力が早い
    - ハンズフリーで使える
    - 物理的な制約を気にしなくていい
        - マイクとスピーカーさえあればいい
        - 物理的なスペースに影響を受けない

ので研究を続けてきた。が、

- 音声情報の場合ユーザーは0から10まで受け取って咀嚼する必要があるので、ユーザーが頭のなかで情報を咀嚼する時間までを含めると全体としてのインタラクションはそこまで早くはない。
- 思い出すタイミングがないためリテンション率が低い

という弱みが見つかった。リテンション率を回避するには日常的に必要となるスキルが定着しやすい。

### クックパッドの試み

- 最初は時短をコアにおいて、パパッと作れる副菜を提案するスキルだった。
    - 使われる場所は家で、タイミングは料理をする直前、最中という仮説で作っていたので、そのあと買い物をすることは想定していなかった。
    - モバイルアプリの代替ではない。
        - そもそもスマホとスマスピの購入動機が違う
        - スマートスピーカーとスマホの機能分担を設計段階でしっかり行う
        - なので、パパッとをメインにしたスキルを作っていた

ただそれだけだと物足りない。

- パパッと料理を作りたい日が週に何日あるのか。
- ユーザの発話に対してレポンスフローを切り分けた
- coookpadのイメージとして「そのレシピはありません」はできない。
- 大根が「鯛とコーン」になってしまう
    - コードでチェックすることはできないので、Alexaとたくさん会話するしかない。
- E2Eテストはあくまでテキストベースなので「正しく認識されれば動く」という保証しかできない。
- スキル開発するときはまずAlexaごっこで考える

### VUIのいいところ

- 思い立ったらすぐ試せる
- 目線を動かす必要がない
- デバイスの汚れを気にする必要がない。
- キッチンでつかうものでもキッチンにある必要はない（声が届けばよい）

[smart kitchen summit japan](https://www.sigmaxyz.com/sks_japan2018/)

- 合わせ調味料メーカー by [Oicy](https://oicy.cookpad.com/)
    - 醤油大さじ1杯とか
    - いつものタレ一人分ちょうだい（できたらいいよね）
    - 照り焼きのタレ、鶏皮一枚分ちょうだいとか（できたらいいよね）

---

## VUI x IoT

Atomph Windowという壁掛けディスプレイを作ってる京都のスタートアップの人のお話。プロダクトめちゃいい！！！

### AtomphのUI（コントローラー）の変遷

#### スマホアプリ
- メリット
    - すぐにインストールできる
    - 物理リモコンがいらない
    - 他の操作もまとめられる
- デメリット
    - 実はスマートじゃない
        - ポケットから出す一連のながれ
        - FaceIDとか
    - 多機能であるがゆえに意外と時間がかかる
    - 個人の持ち物なので、基本認証がかかっている
    - スマホがない人は何もできない

#### 近接センサー

- メリット
    - スマホのオーバーヘッドを回避できる
    - わかってしまえば簡単
- デメリット
    - 複雑な操作は厳しい
    - 近くまで行かないと操作できない
    - 直感的ではない

#### VUI

パブリックな場や家電に向いている

- メリット
    - スマホがいらないのがスマート
    - だれでも使える（アンロックもいらない）
    - 声が届けばいい

究極的には言い方で操作する（Detroitのテレビジョンの例）

サーバからデバイスへのPUSHはAmazonMQを使う
ゼロマッチクエリの監視は入れた方がよさそう。

中野さんの人柄とAtmophのコンセプトに感動したので、Atmoph Window購入します。こんな会社で働きたい。

---

## ログデータ収集の話

ノートとってる余裕なかったので[スライド](https://speakerdeck.com/surumegohan/awswoqu-shi-sitete-xu-chu-yuan-nizhi-tutavuifalse-yin-sheng-rebiyurogudetashou-ji-fen-xi-sisutemu-falsehua)を見よう。

---

## その他参加していないセッションのスライド
公式サイトに[フォローアップ](https://alexaday2019.aajug.jp/follow-up/)が公開されてた。

## まとめ

最後のディスカッションのセッションでも言ってたけど、やっぱりまだキラーコンテンツを待っている印象だし、業界的にもまだまだ発展の段階。
あとはそれぞれの企業内でプライベートスキル（採用とか、受付とか）は作ってそう。（外には出せないので話題にならない）

個人的にはまだWifi必須なのが普及を妨げている一つの要因かなぁとは思う。5Gがどれだけ早く一般的になるかが肝かも。
だれでもがっつり時間とってアイディア固めれば一気に爆発しそうだな。
